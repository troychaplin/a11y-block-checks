(()=>{"use strict";const e=window.wp.i18n,t=window.wp.hooks,i=window.wp.compose,r=window.wp.blockEditor,n=window.wp.components;(0,t.addFilter)("blocks.registerBlockType","block-accessibility-checks/add-image-attribute",(function(e){return"core/image"!==e.name||(e.attributes=Object.assign(e.attributes,{isDecorative:{type:"boolean",default:!1}})),e}));var a=(0,i.createHigherOrderComponent)((function(t){return function(i){if("core/image"!==i.name)return React.createElement(t,i);var a=i.attributes,c=i.setAttributes,o=a.isDecorative;return React.createElement(React.Fragment,null,React.createElement(r.InspectorControls,null,React.createElement(n.PanelBody,{title:(0,e.__)("Accessibility Settings","block-accessibility-checks"),initialOpen:!0},React.createElement(n.ToggleControl,{label:(0,e.__)("Please confirm this image is decorative","block-accessibility-checks"),checked:o,onChange:function(e){return c({isDecorative:e})}}))),React.createElement(t,i))}}),"addImageInspectorControls");(0,t.addFilter)("editor.BlockEdit","block-accessibility-checks/add-inspector-control",a);const c=window.wp.plugins;var o="none",s="error";const l=window.wp.data,u=window.wp.element;var d=(0,i.createHigherOrderComponent)((function(t){return function(i){var r=i.name,n=i.attributes,a=o;if("core/heading"===r&&1===n.level&&(a=s),a===o)return React.createElement(t,i);var c=a===s?"a11y-block-error":"a11y-block-warning",l=a===s?(0,e.__)("Accessibility Error: This heading level is not allowed.","block-accessibility-checks"):(0,e.__)("Warning: This heading level is discouraged.","block-accessibility-checks");return React.createElement("div",{className:c},React.createElement("p",{className:a===s?"a11y-error-msg":"a11y-warning-msg"},l),React.createElement(t,i))}}),"withErrorHandling");function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}wp.hooks.addFilter("editor.BlockEdit","block-accessibility-checks/with-error-handling",d);var f=s,g=[function(t){var i=function(t,r){var n,a=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return b(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?b(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var _n=0,r=function(){};return{s:r,n:function(){return _n>=e.length?{done:!0}:{done:!1,value:e[_n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){c=!0,n=e},f:function(){try{a||null==i.return||i.return()}finally{if(c)throw n}}}}(t);try{for(a.s();!(n=a.n()).done;){var c=n.value;if("core/button"===c.name){var o=c.attributes,s=o.text,l=o.url;if(""===s||void 0===l)return{isValid:!1,message:(0,e.__)("Accessibility Error: Each button must have both text and URL.","block-accessibility-checks"),clientId:r}}if(c.innerBlocks.length>0){var u=i(c.innerBlocks,r);if(!u.isValid)return u}}}catch(e){a.e(e)}finally{a.f()}return{isValid:!0}};return i(t.innerBlocks,t.clientId)},function(t){if("core/heading"===t.name&&1===t.attributes.level){var i={isValid:!0,message:"",clientId:t.clientId,mode:f};switch(f){case"warning":i.isValid=!1,i.message=(0,e.__)("Warning: Level 1 headings are discouraged in your content area.","block-accessibility-checks");break;case s:i.isValid=!1,i.message=(0,e.__)("Accessibility Error: Level 1 headings are not allowed in your content area.","block-accessibility-checks");break;default:i.isValid=!0}return i}return{isValid:!0}},function(t){return"core/image"!==t.name||t.attributes.alt||t.attributes.isDecorative?{isValid:!0}:{isValid:!1,message:(0,e.__)("Accessibility Error: Images are required to have alternative text.","block-accessibility-checks"),clientId:t.clientId}},function(t){return"core/table"===t.name&&0!==t.attributes.body.length&&0===t.attributes.head.length?{isValid:!1,message:(0,e.__)("Accessibility Error: Tables are required to have a header row.","block-accessibility-checks"),clientId:t.clientId}:{isValid:!0}}];(0,c.registerPlugin)("block-validation",{render:function(){var e=(0,l.useSelect)((function(e){return e("core/block-editor").getBlocks()}),[]).flatMap((function(e){return g.map((function(t){return t(e)}))})).filter((function(e){return!e.isValid})),t=(0,l.useDispatch)("core/editor"),i=t.lockPostSaving,r=t.unlockPostSaving,n=t.lockPostAutosaving,a=t.unlockPostAutosaving,c=t.disablePublishSidebar,o=t.enablePublishSidebar;return(0,u.useEffect)((function(){e.some((function(e){return e.mode===s}))&&"DENY"===blockAccessibilitySettings.mode?(i(),n(),c()):(r(),a(),o())}),[e,c,o,n,i,a,r]),null}})})();