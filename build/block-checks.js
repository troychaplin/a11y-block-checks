(()=>{"use strict";const e=window.wp.i18n,t=window.wp.hooks,i=window.wp.compose,r=window.wp.blockEditor,a=window.wp.components;(0,t.addFilter)("blocks.registerBlockType","block-accessibility-checks/add-image-attribute",(function(e){return"core/image"!==e.name||(e.attributes=Object.assign(e.attributes,{isDecorative:{type:"boolean",default:!1}})),e}));var n=(0,i.createHigherOrderComponent)((function(t){return function(i){if("core/image"!==i.name)return React.createElement(t,i);var n=i.attributes,c=i.setAttributes,s=n.isDecorative;return React.createElement(React.Fragment,null,React.createElement(r.InspectorControls,null,React.createElement(a.PanelBody,{title:(0,e.__)("Accessibility Settings","block-accessibility-checks"),initialOpen:!0},React.createElement(a.ToggleControl,{label:(0,e.__)("Please confirm this image is decorative","block-accessibility-checks"),checked:s,onChange:function(e){return c({isDecorative:e})}}))),React.createElement(t,i))}}),"addImageInspectorControls");(0,t.addFilter)("editor.BlockEdit","block-accessibility-checks/add-inspector-control",n);const c=window.wp.plugins;var s="none",o="warning",l="error",d=l;const u=window.wp.data,b=window.wp.element;var m=o;function g(t){if("core/heading"===t.name&&1===t.attributes.level){var i={isValid:!0,message:"",clientId:t.clientId,mode:m};switch(m){case o:i.isValid=!1,i.message=(0,e.__)("Warning: Level 1 headings are discouraged in your content area.","block-accessibility-checks");break;case l:i.isValid=!1,i.message=(0,e.__)("Accessibility Error: Level 1 headings are not allowed in your content area.","block-accessibility-checks");break;default:i.isValid=!0}return i}return{isValid:!0}}var f=l;function h(t){if("core/image"===t.name&&!t.attributes.alt&&!t.attributes.isDecorative){var i={isValid:!0,message:"",clientId:t.clientId,mode:f};switch(f){case o:i.isValid=!1,i.message=(0,e.__)("Accessibility Warning: Images without alternative text are discouraged in your content area.","block-accessibility-checks");break;case l:i.isValid=!1,i.message=(0,e.__)("Accessibility Error: Images are required to have alternative text.","block-accessibility-checks");break;default:i.isValid=!0}return i}return{isValid:!0,mode:s}}var k=(0,i.createHigherOrderComponent)((function(t){return function(i){var r=i.name,a=i.attributes,n=i.clientId,c={isValid:!0,mode:d,message:""};switch(r){case"core/heading":c=g({name:r,attributes:a,clientId:n});break;case"core/image":c=h({name:r,attributes:a,clientId:n});break;default:c={isValid:!0,mode:d,message:""}}if(c.mode===s||c.isValid)return React.createElement(t,i);var o=c.mode===l?"a11y-block-error":"a11y-block-warning",u=c.message||(c.mode===l?(0,e.__)("Accessibility Error: This block does not meet accessibility standards.","block-accessibility-checks"):(0,e.__)("Accessibility Warning: This block may have accessibility issues.","block-accessibility-checks"));return React.createElement("div",{className:o},React.createElement("p",{className:c.mode===l?"a11y-error-msg":"a11y-warning-msg"},u),React.createElement(t,i))}}),"withErrorHandling");function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}wp.hooks.addFilter("editor.BlockEdit","block-accessibility-checks/with-error-handling",k);var v=[function(t){var i=function(t,r){var a,n=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return y(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var _n=0,r=function(){};return{s:r,n:function(){return _n>=e.length?{done:!0}:{done:!1,value:e[_n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){c=!0,a=e},f:function(){try{n||null==i.return||i.return()}finally{if(c)throw a}}}}(t);try{for(n.s();!(a=n.n()).done;){var c=a.value;if("core/button"===c.name){var s=c.attributes,o=s.text,l=s.url;if(""===o||void 0===l)return{isValid:!1,message:(0,e.__)("Accessibility Error: Each button must have both text and URL.","block-accessibility-checks"),clientId:r}}if(c.innerBlocks.length>0){var d=i(c.innerBlocks,r);if(!d.isValid)return d}}}catch(e){n.e(e)}finally{n.f()}return{isValid:!0}};return i(t.innerBlocks,t.clientId)},g,h,function(t){return"core/table"===t.name&&0!==t.attributes.body.length&&0===t.attributes.head.length?{isValid:!1,message:(0,e.__)("Accessibility Error: Tables are required to have a header row.","block-accessibility-checks"),clientId:t.clientId}:{isValid:!0}}];(0,c.registerPlugin)("block-validation",{render:function(){var e=(0,u.useSelect)((function(e){return e("core/block-editor").getBlocks()}),[]).flatMap((function(e){return v.map((function(t){return t(e)}))})).filter((function(e){return!e.isValid})),t=(0,u.useDispatch)("core/editor"),i=t.lockPostSaving,r=t.unlockPostSaving,a=t.lockPostAutosaving,n=t.unlockPostAutosaving,c=t.disablePublishSidebar,s=t.enablePublishSidebar;return(0,b.useEffect)((function(){e.some((function(e){return e.mode===l}))&&"DENY"===blockAccessibilitySettings.mode?(i(),a(),c()):(r(),n(),s())}),[e,c,s,a,i,n,r]),null}})})();