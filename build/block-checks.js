(()=>{"use strict";const e=window.wp.i18n,t=window.wp.hooks,i=window.wp.compose,r=window.wp.blockEditor,a=window.wp.components;(0,t.addFilter)("blocks.registerBlockType","block-accessibility-checks/add-image-attribute",(function(e){return"core/image"!==e.name||(e.attributes=Object.assign(e.attributes,{isDecorative:{type:"boolean",default:!1}})),e}));var n=(0,i.createHigherOrderComponent)((function(t){return function(i){if("core/image"!==i.name)return React.createElement(t,i);var n=i.attributes,c=i.setAttributes,s=n.isDecorative;return React.createElement(React.Fragment,null,React.createElement(r.InspectorControls,null,React.createElement(a.PanelBody,{title:(0,e.__)("Accessibility Settings","block-accessibility-checks"),initialOpen:!0},React.createElement(a.ToggleControl,{label:(0,e.__)("Please confirm this image is decorative","block-accessibility-checks"),checked:s,onChange:function(e){return c({isDecorative:e})}}))),React.createElement(t,i))}}),"addImageInspectorControls");(0,t.addFilter)("editor.BlockEdit","block-accessibility-checks/add-inspector-control",n);const c=window.wp.plugins,s=window.wp.data,o=window.wp.element;var l=BlockAccessibilityChecks.blockChecksOptions.coreHeadingBlockCheck;function d(t){if("core/heading"===t.name&&1===t.attributes.level){var i={isValid:!0,message:"",clientId:t.clientId,mode:l};switch(l){case"error":i.isValid=!1,i.message=(0,e.__)("Accessibility Error: Level 1 headings are not allowed in your content area.","block-accessibility-checks");break;case"warning":i.isValid=!1,i.message=(0,e.__)("Warning: Level 1 headings are discouraged in your content area.","block-accessibility-checks");break;default:i.isValid=!0}return i}return{isValid:!0,mode:"none"}}var u=BlockAccessibilityChecks.blockChecksOptions.coreImageBlockCheck;function b(t){if("core/image"===t.name&&!t.attributes.alt&&!t.attributes.isDecorative){var i={isValid:!0,message:"",clientId:t.clientId,mode:u};switch(u){case"error":i.isValid=!1,i.message=(0,e.__)("Accessibility Error: Images are required to have alternative text.","block-accessibility-checks");break;case"warning":i.isValid=!1,i.message=(0,e.__)("Accessibility Warning: Images without alternative text are discouraged in your content area.","block-accessibility-checks");break;default:i.isValid=!0}return i}return{isValid:!0,mode:"none"}}var m=BlockAccessibilityChecks.blockChecksOptions.coreTableBlockCheck;function k(t){if("core/table"===t.name&&0!==t.attributes.body.length&&0===t.attributes.head.length){var i={isValid:!0,message:"",clientId:t.clientId,mode:m};switch(m){case"error":i.isValid=!1,i.message=(0,e.__)("Accessibility Error: Tables are required to have a header row.","block-accessibility-checks");break;case"warning":i.isValid=!1,i.message=(0,e.__)("Warning: It is recommended that tables have a header row.","block-accessibility-checks");break;default:i.isValid=!0}return i}return{isValid:!0,mode:"none"}}var h=(0,i.createHigherOrderComponent)((function(t){return function(i){var r=i.name,a=i.attributes,n=i.clientId,c={isValid:!0,mode:"none",message:""};switch(r){case"core/heading":c=d({name:r,attributes:a,clientId:n});break;case"core/image":c=b({name:r,attributes:a,clientId:n});break;case"core/table":c=k({name:r,attributes:a,clientId:n});break;default:c={isValid:!0,mode:"none",message:""}}if("none"===c.mode||c.isValid)return React.createElement(t,i);var s="error"===c.mode?"a11y-block-error":"a11y-block-warning",o=c.message||("error"===c.mode?(0,e.__)("Accessibility Error: This block does not meet accessibility standards.","block-accessibility-checks"):(0,e.__)("Accessibility Warning: This block may have accessibility issues.","block-accessibility-checks"));return React.createElement("div",{className:s},React.createElement("p",{className:"error"===c.mode?"a11y-error-msg":"a11y-warning-msg"},o),React.createElement(t,i))}}),"withErrorHandling");function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}(0,t.addFilter)("editor.BlockEdit","block-accessibility-checks/with-error-handling",h);var f=BlockAccessibilityChecks.blockChecksOptions.coreButtonBlockCheck,y=[function(t){var i=function(){var t,r=arguments.length>1?arguments[1]:void 0,a=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return g(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var _n=0,r=function(){};return{s:r,n:function(){return _n>=e.length?{done:!0}:{done:!1,value:e[_n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){c=!0,a=e},f:function(){try{n||null==i.return||i.return()}finally{if(c)throw a}}}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);try{for(a.s();!(t=a.n()).done;){var n=t.value;if("core/button"===n.name){var c=n.attributes,s=c.text,o=c.url;if(!s||!o){var l={isValid:!0,message:"",clientId:r,mode:f};switch(f){case"error":l.isValid=!1,l.message=(0,e.__)("Accessibility Error: Each button must have both text and URL.","block-accessibility-checks");break;case"warning":l.isValid=!1,l.message=(0,e.__)("Accessibility Warning: Each button should have both text and URL.","block-accessibility-checks");break;default:l.isValid=!0}return l}}if(Array.isArray(n.innerBlocks)&&n.innerBlocks.length>0){var d=i(n.innerBlocks,r);if(!d.isValid)return d}}}catch(e){a.e(e)}finally{a.f()}return{isValid:!0,mode:"none"}};return i(t.innerBlocks,t.clientId)},d,b,k];(0,c.registerPlugin)("block-validation",{render:function(){var e=(0,s.useSelect)((function(e){return e("core/block-editor").getBlocks()}),[]).flatMap((function(e){return y.map((function(t){return t(e)}))})).filter((function(e){return!e.isValid})),t=(0,s.useDispatch)("core/editor"),i=t.lockPostSaving,r=t.unlockPostSaving,a=t.lockPostAutosaving,n=t.unlockPostAutosaving,c=t.disablePublishSidebar,l=t.enablePublishSidebar;return(0,o.useEffect)((function(){e.some((function(e){return"error"===e.mode}))?(i(),a(),c()):(r(),n(),l())}),[e,c,l,a,i,n,r]),null}})})();